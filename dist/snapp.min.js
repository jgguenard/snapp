var sn;
(function(c){c.vdom={operation:{APPEND_CHILD:"APPEND_CHILD",REPLACE_CHILD:"REPLACE_CHILD",REMOVE_CHILD:"REMOVE_CHILD",REMOVE_ATTRIBUTE:"REMOVE_ATTRIBUTE",SET_ATTRIBUTE:"SET_ATTRIBUTE",SET_TEXT_CONTENT:"SET_TEXT_CONTENT",SET_EVENT:"SET_EVENT"},node:{COMMENT:8,ELEMENT:1,TEXT:3,COMPONENT:99},setAttribute:function(a,b,c){"class"===b?a.className=c:"style"===b?a.style.cssText=c:"type"!==b&&b in a||"string"!==typeof c?a[b]=null==c?"":c:a.setAttribute?a.setAttribute(b,c):a.attributes&&(a.attributes[b]=c)},
getAttribute:function(a,b){return"class"===b?a.className:"style"===b?a.style.cssText:"type"!==b&&b in a?a[b]:a.getAttribute?a.getAttribute(b):a.attributes&&a.attributes[b]?a.attributes[b].value:null},removeAttribute:function(a,b){"class"===b?a.className="":"style"===b?a.style.cssText="":"type"!==b&&b in a?a[b]="":a.removeAttribute?a.removeAttribute(b):a.attributes&&delete a.attributes[b]},patch:function(a){for(var b in a){var d=a[b];switch(d.type){case c.vdom.operation.APPEND_CHILD:d.target.appendChild(this.createRealNode(d.child));
break;case c.vdom.operation.REPLACE_CHILD:d.target.replaceChild(this.createRealNode(d.child),d.oldChild);break;case c.vdom.operation.REMOVE_CHILD:d.target.removeChild(d.child);break;case c.vdom.operation.REMOVE_ATTRIBUTE:this.removeAttribute(d.target,d.name);break;case c.vdom.operation.SET_ATTRIBUTE:this.setAttribute(d.target,d.name,d.value);break;case c.vdom.operation.SET_TEXT_CONTENT:d.target.textContent=d.value}}},diff:function(a,b,d){var f=[],e=a.attributes||[],h=b.attributes||[];if(!d){for(d=
0;d<e.length;d++){var g=e[d],k=h[g.name],m=this.getAttribute(a,g.name),l=this.getAttribute(b,g.name);k?m!==l&&f.push({type:c.vdom.operation.SET_ATTRIBUTE,target:a,name:g.name,value:l}):f.push({type:c.vdom.operation.REMOVE_ATTRIBUTE,target:a,name:g.name})}for(d=0;d<h.length;d++)g=h[d],e[g.name]||(k=this.getAttribute(b,g.name),f.push({type:c.vdom.operation.SET_ATTRIBUTE,target:a,name:g.name,value:k}))}b.nodeType===c.vdom.node.TEXT&&b.textContent!=a.textContent&&f.push({type:c.vdom.operation.SET_TEXT_CONTENT,
target:a,value:b.textContent});h=b.childNodes?b.childNodes.length:0;e=a.childNodes?a.childNodes.length:0;for(d=0;d<h;d++)g=b.childNodes[d],(k=a.childNodes?a.childNodes[d]:null)?c.isEmpty(g)?f.push({type:c.vdom.operation.REMOVE_CHILD,target:a,child:a.childNodes[d]}):k.nodeType!==g.nodeType||k.tagName!==g.tagName?g.nodeType!==c.vdom.node.COMPONENT&&f.push({type:c.vdom.operation.REPLACE_CHILD,target:a,child:g,oldChild:k}):f=f.concat(this.diff(k,g)):c.isEmpty(g)||f.push({type:c.vdom.operation.APPEND_CHILD,
target:a,child:g});if(h<e)for(b=h;b<e;b++)f.push({type:c.vdom.operation.REMOVE_CHILD,target:a,child:a.childNodes[b]});return f},createRealNode:function(a){var b;if(a.nodeType===c.vdom.node.TEXT)b=document.createTextNode(a.textContent);else if(a.nodeType===c.vdom.node.ELEMENT){b=document.createElement(a.tagName);if(a.attributes)for(var d in a.attributes)this.setAttribute(b,d,a.attributes[d]);if(a.childNodes){d=document.createDocumentFragment();for(var f=0;f<a.childNodes.length;f++){var e=a.childNodes[f];
e&&d.appendChild(this.createRealNode(e,b))}b.appendChild&&b.appendChild(d)}}else a.nodeType===c.vdom.node.COMPONENT&&(b=document.createElement("DIV"),c.mount(b,a.tagName,a.attributes));return b},createVirtualNode:function(a,b,d){c.isDefined(d)||c.isObject(b)||(d=b,b=null);c.isObject(a)?a={nodeType:c.vdom.node.COMPONENT,tagName:a,attributes:b}:(a={tagName:a.toUpperCase(),nodeType:c.vdom.node.ELEMENT,attributes:b},c.isArray(d)?a.childNodes=d:c.isObject(d)?a.childNodes=[d]:c.isEmpty(d)||(a.childNodes=
[{nodeType:c.vdom.node.TEXT,textContent:d}]));return a}}})(sn||(sn={}));var el=sn.vdom.createVirtualNode;
(function(c){c.router={routes:{},params:[],named_params:{},enabled:!1,getPath:function(){var a=window.location.href.match(/#(.*)$/);return"/"+this.clearSlashes(a?a[1]:"")},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},param:function(a,b){return c.isInteger(a)?this.params[a]||b:this.named_params[a]||b},update:function(){var a=this,b=this.getPath(),d=[],f={},b=b.replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(b,a,c){f[a]=decodeURIComponent(c);return""}),e={},h;for(h in this.routes){e.rule=
h;var g="^"+e.rule.replace(/:[^/]+/g,"([^/]+)")+"$";if(g=b.match(g)){g.shift();var b=e.rule.match(/:([^/:]+)/g),k;for(k in b)h=decodeURIComponent(g[k]),d.push(h),f[b[k].replace(":","")]=h;this.params=d;this.named_params=f;setTimeout(function(b){return function(){c.log("Taking route "+b.rule);a.routes[b.rule]()}}(e),0);break}e={rule:e.rule}}},setEnabled:function(a){!0!==a||this.enabled?a||(window.removeEventListener("hashchange",this.update.bind(this)),this.enabled=!1):(window.addEventListener("hashchange",
this.update.bind(this)),this.enabled=!0,this.update())},setRoutes:function(a){this.routes=a;this.setEnabled(!0)},redirect:function(a,b){if(b)for(var c in b)a=a.replace(":"+c,encodeURIComponent(b[c]));window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a}}})(sn||(sn={}));
(function(c){c.component={lifeCycle:["init","update","render","dispose"],abortComponentRendering:function(b){b.$pendingRendering&&(c.log("Ignoring rendering request of component <"+b.definition.name+">"),clearTimeout(b.$pendingRendering))},requestComponentRendering:function(b){this.abortComponentRendering(b);b.$pendingRendering=setTimeout(function(){b.render();b.$pendingRendering=null},0)},propertyChanged:function(b,a){c.log("Rendering component <"+b.definition.name+"> triggered by <"+b.definition.name+
"::"+a.toString()+">");this.requestComponentRendering(b)}};var a=function(b){this.definition=b;this.observables=[];var a=this;this.scope=new Proxy({},{get:function(b,e){!c.isDefined(b[e])||c.isFunction(b[e])||c.inArray(a.observables,e)||(c.log("Observing property <"+a.definition.name+"."+e.toString()+">"),a.observables.push(e));return b[e]},set:function(b,e,h){b[e]=h;!c.isFunction(h)&&c.inArray(a.observables,e)&&c.component.propertyChanged(a,e);return!0}})};a.prototype.mount=function(b,a){c.log("Mounting component <"+
this.definition.name+">");var f=c.vdom.getAttribute(b,"data-sn-component");c.isDefined(f)&&f.dispose();c.vdom.setAttribute(b,"data-sn-component",this);this.container=b;for(var e in this.definition)"function"==typeof this.definition[e]&&0>c.component.lifeCycle.indexOf(e)&&(this.scope[e]=this.definition[e]);this.init(a);this.update(a);c.log("Component <"+this.definition.name+"> mounted")};a.prototype.controller=function(b,a){if(this.definition[b])if(arguments){var c=[],e;for(e in a)c.push(a[e]);this.definition[b].apply(this.scope,
c)}else this.definition[b].call(this.scope)};a.prototype.init=function(b){this.controller("init",b);c.log("Component <"+this.definition.name+"> initialized")};a.prototype.update=function(b){this.controller("update",b);c.component.requestComponentRendering(this);c.log("Component <"+this.definition.name+"> updated")};a.prototype.render=function(){if(this.definition.render){var b=this.definition.render.call(this.scope),b=c.vdom.createVirtualNode(this.container.tagName,null,b),b=c.vdom.diff(this.container,
b,!0);c.vdom.patch(b);c.log("Component <"+this.definition.name+"> rendered")}};a.prototype.dispose=function(){c.component.abortComponentRendering(this);this.definition.dispose&&this.definition.dispose.call(this.scope);c.log("Component <"+this.definition.name+"> unmounted")};c.Component=a})(sn||(sn={}));
(function(c){var a=function(b,a,f,e){this.url=a;this.method=b;this.data=f;this.options=c.extend({timeout:5E3,async:!0,withCredentials:!1,ct:"application/x-www-form-urlencoded"},e||{});this.init()};a.prototype.abort=function(){this.xhr.abort();this.failCallback&&this.failCallback(this.xhr.status);this.alwaysCallback&&this.alwaysCallback()};a.prototype.init=function(){var a=this;try{this.xhr=new XMLHttpRequest}catch(d){try{this.xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){return c.error("XMLHttpRequest not supported"),
null}}this.xhr.withCredentials&&(this.xhr.withCredentials=this.options.withCredentials);this.xhr.onreadystatechange=function(){4==a.xhr.readyState&&(clearTimeout(a.requestTimeout),200!=a.xhr.status?a.failCallback&&a.failCallback(a.xhr.responseText,a.xhr):a.successCallback&&a.successCallback(a.xhr.responseText,a.xhr),a.alwaysCallback&&a.alwaysCallback(a.xhr.responseText,a.xhr))};this.requestTimeout=setTimeout(function(){a.abort()},this.options.timeout);this.xhr.open(this.method.toUpperCase(),this.url,
this.options.async);this.data?(this.xhr.setRequestHeader("Content-type",this.options.ct),this.xhr.send(this.data)):this.xhr.send(null)};a.prototype.success=function(a){this.successCallback=a;return this};a.prototype.fail=function(a){this.failCallback=a;return this};a.prototype.always=function(a){this.alwaysCallback=a;return this};c.RequestObject=a;c.request={get:function(a,d,f){return new c.RequestObject("GET",a,d,f)},post:function(a,d,f){return new c.RequestObject("POST",a,d,f)}}})(sn||(sn={}));
(function(c){c.config={logPrefix:"sn: ",debug:!0};c.error=function(a){if(!0===c.config.debug)throw Error(c.config.logPrefix+a);};c.log=function(a){!0===c.config.debug&&console.log(c.config.logPrefix+a)};c.extend=function(a,b){return Object.assign?Object.assign(a,b):a};c.isObject=function(a){return"object"===typeof a};c.isArray=function(a){return Array.isArray(a)};c.isDefined=function(a){return void 0!==a&&null!==a};c.isFunction=function(a){return"function"===typeof a};c.inArray=function(a,b){return 0<=
a.indexOf(b)};c.isInteger=function(a){var b;return isNaN(a)?!1:(b=parseFloat(a),(0|b)===b)};c.isEmpty=function(a){return!c.isDefined(a)||""===a||c.isObject(a)&&0===Object.keys(a).length};c.mount=function(a,b,d){var f=c.vdom.getAttribute(a,"data-sn-component");f&&f.definition===b?f.update(d):(new c.Component(b)).mount(a,d)}})(sn||(sn={}));
