var sn;
(function(d){d.config={logPrefix:"snapp: ",debug:!0};d.log=function(a){!0===d.config.debug&&console.log(d.config.logPrefix+a)};d.isInteger=function(a){var b;return isNaN(a)?!1:(b=parseFloat(a),(0|b)===b)};d.mount=function(a,b){(new d.Component(b)).mount(a)};var a=function(a){this.activeRenderJob=null;this.definition=a;this.observables=[];var b=this;this.scope=new Proxy({},{get:function(a,c){void 0!==a[c]&&"function"!==typeof a[c]&&0>b.observables.indexOf(c)&&(d.log("Observing property <"+b.definition.name+"::"+
c.toString()+">"),b.observables.push(c));return a[c]},set:function(a,c,f){a[c]=f;"function"!==typeof f&&0<=b.observables.indexOf(c)&&(d.log("Rendering of <"+b.definition.name+"> triggered by observable <"+b.definition.name+"::"+c.toString()+">"),b.render());return!0}})};a.prototype.mount=function(a){d.log("Mounting component <"+this.definition.name+">");this.container=a;this.vContainer=d.vdom.createVirtualContainer(a);for(var b in this.definition)"function"==typeof this.definition[b]&&(this.scope[b]=
this.definition[b]);this.definition.controller&&this.definition.controller.call(this.scope);this.render();d.log("Component <"+this.definition.name+"> mounted")};a.prototype.unmount=function(){d.log("Component <"+this.definition.name+"> unmounted")};a.prototype.render=function(){var a=this;this.definition.view&&(this.activeRenderJob&&(d.log("Rendering request for <"+this.definition.name+"> ignored"),clearTimeout(this.activeRenderJob)),this.activeRenderJob=setTimeout(function(){var b=a.definition.view.call(a.scope,
a.vContainer);d.vdom.isVirtualNode(b)&&(b=d.vdom.createVirtualContainer(b));b=d.vdom.diff(a.container,b);d.vdom.apply(b);d.log("Rendering component <"+a.definition.name+">");a.activeRenderJob=null},100))};d.Component=a})(sn||(sn={}));
(function(d){d.router={routes:{},params:[],named_params:{},enabled:!1,getPath:function(){var a=window.location.href.match(/#(.*)$/);return"/"+this.clearSlashes(a?a[1]:"")},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},param:function(a,c){return d.isInteger(a)?this.params[a]||c:this.named_params[a]||c},update:function(){var a=this.getPath(),c=[],b={},a=a.replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(a,c,d){b[c]=decodeURIComponent(d);return""}),e;for(e in this.routes){var h=
"^"+e.replace(/:[^/]+/g,"([^/]+)")+"$";if(h=a.match(h)){h.shift();var a=e.match(/:([^/:]+)/g),f;for(f in a){var g=decodeURIComponent(h[f]);c.push(g);b[a[f].replace(":","")]=g}this.params=c;this.named_params=b;d.log("Taking route "+e);this.routes[e]();break}}},setEnabled:function(a){var c=this;!0!==a||this.enabled?a||(window.removeEventListener("hashchange",this.update.bind(this)),this.enabled=!1):setTimeout(function(){window.addEventListener("hashchange",c.update.bind(c));c.enabled=!0;c.update()},
0)},setRoutes:function(a){this.routes=a;this.setEnabled(!0)},redirect:function(a,c){if(c)for(var b in c)a=a.replace(":"+b,encodeURIComponent(c[b]));window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a}}})(sn||(sn={}));
(function(d){d.vdom={operation:{APPEND_CHILD:"APPEND_CHILD",REPLACE_CHILD:"REPLACE_CHILD",REMOVE_CHILD:"REMOVE_CHILD",REMOVE_ATTRIBUTE:"REMOVE_ATTRIBUTE",SET_ATTRIBUTE:"SET_ATTRIBUTE",SET_EVENT:"SET_EVENT"},node:{COMMENT:8,ELEMENT:1,TEXT:3},setAttribute:function(a,c,b){"class"===c?a.className=b:"style"===c?a.style.cssText=b:"type"!==c&&c in a||"string"!==typeof b?a[c]=null==b?"":b:a.setAttribute?a.setAttribute(c,b):a.attributes&&(a.attributes[c]=b)},getAttribute:function(a,c){if("class"===c)return a.className;
if("style"===c)return a.style.cssText;if("type"!==c&&c in a)return a[c];if(a.getAttribute)return a.getAttribute(c);if(a.attributes&&a.attributes[c])return a.attributes[c].value},removeAttribute:function(a,c){"class"===c?a.className="":"style"===c?a.style.cssText="":"type"!==c&&c in a?a[c]="":a.removeAttribute?a.removeAttribute(c):a.attributes&&delete a.attributes[c]},diffNode:function(a,c){for(var b=[],e=a.attributes||[],h=c.attributes||[],f=0;f<e.length;f++){var g=e[f],k=h[g.name],m=this.getAttribute(a,
g.name),l=this.getAttribute(c,g.name);k?m!==l&&b.push({type:d.vdom.operation.SET_ATTRIBUTE,source:a,destination:c,attribute:{name:g.name,value:l}}):b.push({type:d.vdom.operation.REMOVE_ATTRIBUTE,source:a,attribute:{name:g.name}})}for(f=0;f<h.length;f++)g=h[f],e[g.name]||(k=this.getAttribute(c,g.name),b.push({type:d.vdom.operation.SET_ATTRIBUTE,source:a,destination:c,attribute:{name:g.name,value:k}}));return b=b.concat(this.diff(a,c))},diff:function(a,c){for(var b=[],e=c.childNodes?c.childNodes.length:
0,h=a.childNodes?a.childNodes.length:0,f=0;f<e;f++){var g=c.childNodes[f],k=a.childNodes[f];k?k.nodeType!==g.nodeType||k.tagName||k.tagName!==g.tagName?b.push({type:d.vdom.operation.REPLACE_CHILD,source:a,destination:g,node:k}):b=b.concat(this.diffNode(k,g)):b.push({type:d.vdom.operation.APPEND_CHILD,source:a,node:g})}if(e<h)for(;e<h;e++)b.push({type:d.vdom.operation.REMOVE_CHILD,source:a,node:a.childNodes[e]});return b},apply:function(a){for(var c in a){var b=a[c];switch(b.type){case d.vdom.operation.APPEND_CHILD:var e=
this.cloneNode(b.node);b.source.appendChild(e);break;case d.vdom.operation.REPLACE_CHILD:e=this.isVirtualNode(b.destination)?this.createRealNode(b.destination):b.destination;b.source.replaceChild(e,b.node);break;case d.vdom.operation.REMOVE_CHILD:b.source.removeChild(b.node);break;case d.vdom.operation.REMOVE_ATTRIBUTE:this.removeAttribute(b.source,b.attribute.name);break;case d.vdom.operation.SET_ATTRIBUTE:this.setAttribute(b.source,b.attribute.name,b.attribute.value)}}},cloneNode:function(a){return a.cloneNode?
a.cloneNode(!0):this.createRealNode(a)},createRealNode:function(a){var c;if(a.nodeType===d.vdom.node.TEXT)c=document.createTextNode(a.textContent);else if(a.nodeType===d.vdom.node.ELEMENT){c=document.createElement(a.tagName);if(a.attributes)for(var b=0;b<a.attributes.length;b++){var e=a.attributes[b];this.setAttribute(c,e.name,e.value)}if(a.childNodes){e=this.createVirtualContainer();for(b=0;b<a.childNodes.length;b++)e.appendChild(this.createRealNode(a.childNodes[b]));c.appendChild&&c.appendChild(e)}}return c},
createVirtualNode:function(a,c,b){var e;"object"!==typeof a&&(e={tagName:a.toUpperCase(),nodeType:d.vdom.node.ELEMENT,attributes:c,virtual:!0},Array.isArray(b)?e.childNodes=b:e.childNodes="object"===typeof b?[b]:[{nodeType:d.vdom.node.TEXT,textContent:b,virtual:!0}]);return e},createVirtualContainer:function(a){var c,b=this.isVirtualNode(a);if(a||!b)c=document.createDocumentFragment();if(!0===b)c={nodeType:d.vdom.node.ELEMENT,tagName:"DIV",childNodes:[a]};else if(a)for(var e in a.childNodes)b=a.childNodes[e],
b.cloneNode&&(b=b.cloneNode(!0),c.appendChild(b));return c},isVirtualNode:function(a){return a&&!0===a.virtual}}})(sn||(sn={}));var el=sn.vdom.createVirtualNode;
