var sn;
(function(c){c.vdom={operation:{APPEND_CHILD:"APPEND_CHILD",REPLACE_CHILD:"REPLACE_CHILD",REMOVE_CHILD:"REMOVE_CHILD",REMOVE_ATTRIBUTE:"REMOVE_ATTRIBUTE",SET_ATTRIBUTE:"SET_ATTRIBUTE",SET_TEXT_CONTENT:"SET_TEXT_CONTENT",SET_EVENT:"SET_EVENT"},allowedTagName:"A ABBR ADDRESS AREA ARTICLE ASIDE AUDIO B BASE BDI BDO BGSOUND BLOCKQUOTE BODY BR BUTTON CANVAS CAPTION CITE CODE COL COLGROUP COMMAND CONTENT DATA DATALIST DD DEL DETAILS DFN DIALOG DIV DL DT ELEMENT EM EMBED FIELDSET FIGCAPTION FIGURE FONT FOOTER FORM H1 H2 H3 H4 H5 H6 HEAD HEADER HGROUP HR HTML I IFRAME IMAGE IMG INPUT INS KBD KEYGEN LABEL LEGEND LI LINK MAIN MAP MARK MARQUEE MENU MENUITEM META METER MULTICOL NAV NOBR NOEMBED NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION OUTPUT P PARAM PICTURE PRE PROGRESS Q RP RT RTC RUBY S SAMP SCRIPT SECTION SELECT SHADOW SMALL SOURCE SPAN STRONG STYLE SUB SUMMARY SUP TABLE TBODY TD TEMPLATE TEXTAREA TFOOT TH THEAD TIME TITLE TR TRACK U UL VAR VIDEO WBR".split(" "),node:{COMMENT:8,
ELEMENT:1,TEXT:3,COMPONENT:99},setAttribute:function(a,b,e){!0===a.$virtual?a.attributes[b]=e:"class"===b?a.className=e:"style"===b?a.style.cssText=e:"type"!==b&&b in a||"string"!==typeof e?a[b]=null==e?"":e:a.setAttribute?a.setAttribute(b,e):a.attributes&&(a.attributes[b].value=e)},getAttribute:function(a,b){return!0===a.$virtual?a.attributes[b]:"class"===b?a.className:"style"===b?a.style.cssText:"type"!==b&&b in a?a[b]:a.getAttribute?a.getAttribute(b):a.attributes?a.attributes[b].value:null},removeAttribute:function(a,
b){!0===a.$virtual?delete a.attributes[b]:"class"===b?a.className="":"style"===b?a.style.cssText="":"type"!==b&&b in a?a[b]="":a.removeAttribute?a.removeAttribute(b):a.attributes&&delete a.attributes[b]},patch:function(a,b){for(var e in a){var d=a[e];switch(d.type){case c.vdom.operation.APPEND_CHILD:d.target.appendChild(this.createRealNode(d.child,b));break;case c.vdom.operation.REPLACE_CHILD:d.target.replaceChild(this.createRealNode(d.child,b),d.oldChild);break;case c.vdom.operation.REMOVE_CHILD:d.target.removeChild(d.child);
break;case c.vdom.operation.REMOVE_ATTRIBUTE:this.removeAttribute(d.target,d.name);break;case c.vdom.operation.SET_ATTRIBUTE:"function"===typeof d.value&&(d.value=d.value.bind(b));this.setAttribute(d.target,d.name,d.value);break;case c.vdom.operation.SET_TEXT_CONTENT:d.target.textContent=d.value}}},diff:function(a,b,e){var d=[],g=a.attributes||[],f=b.attributes||{};if(!e){for(e=0;e<g.length;e++){var h=g[e],k=f[h.name],m=this.getAttribute(a,h.name),n=this.getAttribute(b,h.name);k?m!==n&&d.push({type:c.vdom.operation.SET_ATTRIBUTE,
target:a,name:h.name,value:n}):d.push({type:c.vdom.operation.REMOVE_ATTRIBUTE,target:a,name:h.name})}for(var l in f){f=!1;for(e=0;e<g.length;e++)if(g[e].name===l){f=!0;break}f||(f=this.getAttribute(b,l),d.push({type:c.vdom.operation.SET_ATTRIBUTE,target:a,name:l,value:f}))}}b.nodeType===c.vdom.node.TEXT&&b.textContent!=a.textContent&&d.push({type:c.vdom.operation.SET_TEXT_CONTENT,target:a,value:b.textContent});l=b.childNodes?b.childNodes.length:0;g=a.childNodes?a.childNodes.length:0;for(f=0;f<l;f++)if(e=
b.childNodes[f],h=a.childNodes?a.childNodes[f]:null)if(c.isEmpty(e))d.push({type:c.vdom.operation.REMOVE_CHILD,target:a,child:a.childNodes[f]});else if(h.nodeType!==e.nodeType||h.tagName!==e.tagName){var m=(k=e.nodeType===c.vdom.node.COMPONENT)?e.tagName.name:null,p=(n=this.getAttribute(h,"data-sn-component"))?n.definition.name:null;(!k||n&&p!==m)&&d.push({type:c.vdom.operation.REPLACE_CHILD,target:a,child:e,oldChild:h})}else d=d.concat(this.diff(h,e));else c.isEmpty(e)||d.push({type:c.vdom.operation.APPEND_CHILD,
target:a,child:e});if(l<g)for(b=l;b<g;b++)d.push({type:c.vdom.operation.REMOVE_CHILD,target:a,child:a.childNodes[b]});return d},createRealNode:function(a,b){var e;if(a.nodeType===c.vdom.node.TEXT)e=document.createTextNode(a.textContent);else if(a.nodeType===c.vdom.node.ELEMENT){e=document.createElement(a.tagName);if(a.attributes)for(var d in a.attributes){var g=a.attributes[d];"function"===typeof g&&(g=g.bind(b));this.setAttribute(e,d,g)}if(a.childNodes){d=document.createDocumentFragment();for(g=
0;g<a.childNodes.length;g++){var f=a.childNodes[g];f&&d.appendChild(this.createRealNode(f,b))}e.appendChild&&e.appendChild(d)}}else a.nodeType===c.vdom.node.COMPONENT&&(e=document.createElement("DIV"),c.mount(e,a.tagName,a.attributes));return e},createVirtualNode:function(a,b,e){c.isDefined(e)||!c.isDefined(b)||!c.isArray(b)&&c.isObject(b)&&!0!==b.$virtual||(e=b,b=null);if(c.isObject(a))a={nodeType:c.vdom.node.COMPONENT,tagName:a,attributes:b};else{var d=a.toString().toUpperCase();c.inArray(c.vdom.allowedTagName,
d)?(a={tagName:d,nodeType:c.vdom.node.ELEMENT,attributes:b},c.isArray(e)?a.childNodes=e:c.isObject(e)?a.childNodes=[e]:c.isEmpty(e)||(a.childNodes=[{nodeType:c.vdom.node.TEXT,textContent:e}])):a={nodeType:c.vdom.node.TEXT,textContent:a}}a.$virtual=!0;return a}}})(sn||(sn={}));var el=sn.vdom.createVirtualNode;
(function(c){c.router={routes:{},params:[],named_params:{},enabled:!1,getPath:function(){var a=window.location.href.match(/#(.*)$/);return"/"+this.clearSlashes(a?a[1]:"")},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},param:function(a,b){return c.isInteger(a)?this.params[a]||b:this.named_params[a]||b},update:function(){var a=this,b=this.getPath(),e=[],d={},b=b.replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(b,a,e){d[a]=decodeURIComponent(e);return""}),g={},f;for(f in this.routes){g.rule=
f;var h="^"+g.rule.replace(/:[^/]+/g,"([^/]+)")+"$";if(h=b.match(h)){h.shift();var b=g.rule.match(/:([^/:]+)/g),k;for(k in b)f=decodeURIComponent(h[k]),e.push(f),d[b[k].replace(":","")]=f;this.params=e;this.named_params=d;setTimeout(function(b){return function(){c.log("Taking route "+b.rule);a.routes[b.rule]()}}(g),0);break}g={rule:g.rule}}},setEnabled:function(a){!0!==a||this.enabled?a||(window.removeEventListener("hashchange",this.update.bind(this)),this.enabled=!1):(window.addEventListener("hashchange",
this.update.bind(this)),this.enabled=!0,this.update())},setRoutes:function(a){this.routes=a;this.setEnabled(!0)},route:function(a,b){if(b)for(var e in b)a=a.replace(":"+e,encodeURIComponent(b[e]));window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a}}})(sn||(sn={}));
(function(c){c.component={lifeCycle:["init","update","render","dispose"],abortComponentRendering:function(b){b.$pendingRendering&&(c.log("Ignoring rendering request of component <"+b.definition.name+">"),clearTimeout(b.$pendingRendering))},requestComponentRendering:function(b){this.abortComponentRendering(b);b.$pendingRendering=setTimeout(function(){b.render();b.$pendingRendering=null},0)},observablePropertyChanged:function(b,a,d,g,f,h){c.log("Rendering component <"+b.definition.name+"> triggered by <"+
g.toString()+"> of scope <!"+a+">");this.requestComponentRendering(b);if(b=d.$observers?d.$observers[g]:null)for(var k in b)b[k](f,h)},observe:function(b,a,c){a.$observers||(a.$observers={});a.$observers[b]||(a.$observers[b]=[]);a.$observers[b].push(c)}};var a=function(b){this.definition=b;this.observables=[];this.scope=this.createScope()};a.prototype.createScope=function(b){var a=this,d=c.guid();return new Proxy(b||{},{get:function(b,f){var h=d+f.toString();!c.isDefined(b[f])||c.isFunction(b[f])||
"__proto__"===f||f.toString().startsWith("$")||c.inArray(a.observables,h)||(c.log("Observing property <"+f.toString()+"> of scope <"+d+">"),a.observables.push(h));return b[f]},set:function(b,f,h){var k=d+f.toString(),m=b[f];"object"!==typeof h||f.toString().startsWith("$")||(h=a.createScope(h));b[f]=h;h!==m&&!c.isFunction(h)&&c.inArray(a.observables,k)&&c.component.observablePropertyChanged(a,d,b,f,h,m);return!0}})};a.prototype.mount=function(b,a){c.log("Mounting component <"+this.definition.name+
">");var d=c.vdom.getAttribute(b,"data-sn-component");c.isDefined(d)&&d.dispose();c.vdom.setAttribute(b,"data-sn-component",this);this.container=b;for(var g in this.definition)"function"==typeof this.definition[g]&&0>c.component.lifeCycle.indexOf(g)&&(this.scope[g]=this.definition[g]);this.init(a);this.update(a);c.log("Component <"+this.definition.name+"> mounted")};a.prototype.controller=function(b,a){if(this.definition[b])if(arguments){var c=[],g;for(g in a)c.push(a[g]);this.definition[b].apply(this.scope,
c)}else this.definition[b].call(this.scope)};a.prototype.init=function(b){this.controller("init",b);c.log("Component <"+this.definition.name+"> initialized")};a.prototype.update=function(b){this.controller("update",b);c.component.requestComponentRendering(this);c.log("Component <"+this.definition.name+"> updated")};a.prototype.render=function(){if(this.definition.render){var b=this.definition.render.call(this.scope),b=c.vdom.createVirtualNode(this.container.tagName,null,b),b=c.vdom.diff(this.container,
b,!0);c.vdom.patch(b,this.scope);c.log("Component <"+this.definition.name+"> rendered")}};a.prototype.dispose=function(){c.component.abortComponentRendering(this);this.definition.dispose&&this.definition.dispose.call(this.scope);c.log("Component <"+this.definition.name+"> unmounted")};c.Component=a})(sn||(sn={}));
(function(c){var a=function(b,a,d,g){this.url=a;this.method=b;this.data=d;this.options=c.extend({timeout:5E3,async:!0,dataType:"JSON",withCredentials:!1,ct:"application/x-www-form-urlencoded"},g||{});this.init()};a.prototype.prepareParams=function(b,a){var c=[],g;for(g in b)if(b.hasOwnProperty(g)){var f=a?a+"["+g+"]":g,h=b[g];c.push("object"==typeof h?this.prepareParams(h,f):encodeURIComponent(f)+"="+encodeURIComponent(h))}return c.join("&")};a.prototype.stringToJSON=function(b){return JSON.parse(b)};
a.prototype.abort=function(){this.xhr.abort();this.failCallback&&this.failCallback(this.xhr.status);this.alwaysCallback&&this.alwaysCallback()};a.prototype.init=function(){var b=this;try{this.xhr=new XMLHttpRequest}catch(a){try{this.xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){return c.error("XMLHttpRequest not supported"),null}}this.xhr.withCredentials&&(this.xhr.withCredentials=this.options.withCredentials);this.xhr.onreadystatechange=function(){if(4==b.xhr.readyState){clearTimeout(b.requestTimeout);
if(200!=b.xhr.status)b.failCallback&&b.failCallback(b.xhr.responseText,b.xhr);else{var a=b.xhr.responseText;"JSON"===b.options.dataType&&(a=b.stringToJSON(a));b.successCallback&&b.successCallback(a,b.xhr)}b.alwaysCallback&&b.alwaysCallback(b.xhr.responseText,b.xhr)}};this.requestTimeout=setTimeout(function(){b.abort()},this.options.timeout);var e=this.method.toUpperCase(),d=this.url+(this.data&&"GET"===e?"?"+this.prepareParams(this.data):"");this.xhr.open(e,d,this.options.async);"POST"===e&&this.data?
(this.xhr.setRequestHeader("Content-type",this.options.ct),this.xhr.send(this.prepareParams(this.data))):this.xhr.send(null)};a.prototype.success=function(b){this.successCallback=b;return this};a.prototype.fail=function(b){this.failCallback=b;return this};a.prototype.always=function(b){this.alwaysCallback=b;return this};c.RequestObject=a;c.request={get:function(b,a,d){return new c.RequestObject("GET",b,a,d)},post:function(b,a,d){return new c.RequestObject("POST",b,a,d)}}})(sn||(sn={}));
(function(c){c.validation={required:function(a){return!c.isEmpty(a)}}})(sn||(sn={}));
(function(c){c.form=function(b,a){return new c.FormObject(b,a)};c.FormField={name:"FormField",init:function(b,a,d,g){var f=this;this.value=b[a]||"";c.component.observe(a,b,function(b,c){f.$form.validateField(a,b);f.value=b})},update:function(b,a,d,g){var f=this;this.$form=b;this.$options=c.extend({updateEvent:"onchange",updateDebounce:0,choices:null,multiline:!1},g||{});this.$attributes=c.extend({name:a},d||{});var h=function(b){f.$form.setFieldValue(a,b.target.value);f.$form.setPristine(!1)},k;this.$attributes[this.$options.updateEvent]=
this.$options.updateDebounce?function(b){clearTimeout(k);k=setTimeout(h.bind(f,b),f.$options.updateDebounce)}:h},render:function(){var b=c.extend({},this.$attributes),a=c.isEmpty(b["class"]||"")?"":" ";c.isEmpty(this.$form.$errors[b.name])?a+="sn-valid":(a+="sn-invalid",this.$form.$errors[b.name].map(function(b){a+=" sn-invalid-"+b.replace("_","-")}));b["class"]=a;var d=this.$options.choices?"SELECT":!0===this.$options.multiline?"TEXTAREA":"INPUT",g=[];if("SELECT"===d)for(var f in this.$options.choices)g.push(el("option",
{value:f,selected:f==this.value},this.$options.choices[f]));else"INPUT"===d?(b.type||(b.type="text"),"checkbox"===b.type?(b.checked=this.$options.value==this.value,b.value=this.$options.value):"radio"===b.type?b.checked=b.value==this.value:b.value=this.value):b.value=this.value;return el(d,b,g)}};var a=function(b,a){this.$fields=b||{};this.$errors={};this.$pristine=!0;c.isDefined(a)&&this.setFieldsValue(a)};a.prototype.serialize=function(){var b={},a;for(a in this.$fields)b[a]=this[a];return b};a.prototype.setPristine=
function(a){this.$pristine=!0===a};a.prototype.setFieldValue=function(a,c){this[a]=c};a.prototype.setFieldsValue=function(a){for(var c in a)this.setFieldValue(c,a[c])};a.prototype.isValid=function(){for(var a in this.$errors)if(!c.isEmpty(this.$errors[a]))return!1;return!0};a.prototype.isPristine=function(){return this.$pristine};a.prototype.validateField=function(a,e){var d=[];if(this.$fields[a]){var g=this.$fields[a].validation;if(!c.isEmpty(g)){c.isArray(g)||(g=[g]);for(var f in g){var h=g[f];
!0!==c.validation[h](e)&&d.push(h)}}}this.$errors[a]=d;return 0>d.length};a.prototype.field=function(a,e){return el(c.FormField,{form:this,name:a,attributes:e,options:this.$fields[a]})};c.FormObject=a})(sn||(sn={}));
(function(c){c.config={logPrefix:"sn: ",debug:!1};c.error=function(a){if(!0===c.config.debug)throw Error(c.config.logPrefix+a);};c.log=function(a){!0===c.config.debug&&console.log(c.config.logPrefix+a)};c.extend=function(a,b){return Object.assign?Object.assign(a,b):a};c.isObject=function(a){return"object"===typeof a};c.isArray=function(a){return Array.isArray(a)};c.isDefined=function(a){return void 0!==a&&null!==a};c.isFunction=function(a){return"function"===typeof a};c.inArray=function(a,b){return 0<=
a.indexOf(b)};c.isInteger=function(a){var b;return isNaN(a)?!1:(b=parseFloat(a),(0|b)===b)};c.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};c.isEmpty=function(a){return!c.isDefined(a)||""===a||c.isArray(a)&&1>a.length||c.isObject(a)&&1>Object.keys(a).length};c.mount=function(a,b,e){var d=c.vdom.getAttribute(a,"data-sn-component");d&&d.definition===b?d.update(e):(new c.Component(b)).mount(a,
e)}})(sn||(sn={}));
