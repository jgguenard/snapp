var sn;
(function(b){b.vdom={operation:{APPEND_CHILD:"APPEND_CHILD",REPLACE_CHILD:"REPLACE_CHILD",REMOVE_CHILD:"REMOVE_CHILD",REMOVE_ATTRIBUTE:"REMOVE_ATTRIBUTE",SET_ATTRIBUTE:"SET_ATTRIBUTE",SET_TEXT_CONTENT:"SET_TEXT_CONTENT",SET_EVENT:"SET_EVENT"},node:{COMMENT:8,ELEMENT:1,TEXT:3,COMPONENT:99},setAttribute:function(a,c,b){!0===a.$virtual?a.attributes[c]=b:"class"===c?a.className=b:"style"===c?a.style.cssText=b:"type"!==c&&c in a||"string"!==typeof b?a[c]=null==b?"":b:a.setAttribute?a.setAttribute(c,b):
a.attributes&&(a.attributes[c].value=b)},getAttribute:function(a,c){return!0===a.$virtual?a.attributes[c]:"class"===c?a.className:"style"===c?a.style.cssText:"type"!==c&&c in a?a[c]:a.getAttribute?a.getAttribute(c):a.attributes?a.attributes[c].value:null},removeAttribute:function(a,c){!0===a.$virtual?delete a.attributes[c]:"class"===c?a.className="":"style"===c?a.style.cssText="":"type"!==c&&c in a?a[c]="":a.removeAttribute?a.removeAttribute(c):a.attributes&&delete a.attributes[c]},patch:function(a,
c){for(var e in a){var d=a[e];switch(d.type){case b.vdom.operation.APPEND_CHILD:d.target.appendChild(this.createRealNode(d.child,c));break;case b.vdom.operation.REPLACE_CHILD:d.target.replaceChild(this.createRealNode(d.child,c),d.oldChild);break;case b.vdom.operation.REMOVE_CHILD:d.target.removeChild(d.child);break;case b.vdom.operation.REMOVE_ATTRIBUTE:this.removeAttribute(d.target,d.name);break;case b.vdom.operation.SET_ATTRIBUTE:this.setAttribute(d.target,d.name,d.value);break;case b.vdom.operation.SET_TEXT_CONTENT:d.target.textContent=
d.value}}},diff:function(a,c,e){var d=[],g=a.attributes||[],f=c.attributes||{};if(!e){for(e=0;e<g.length;e++){var h=g[e],k=f[h.name],m=this.getAttribute(a,h.name),n=this.getAttribute(c,h.name);k?m!==n&&d.push({type:b.vdom.operation.SET_ATTRIBUTE,target:a,name:h.name,value:n}):d.push({type:b.vdom.operation.REMOVE_ATTRIBUTE,target:a,name:h.name})}for(var l in f){f=!1;for(e=0;e<g.length;e++)if(g[e].name===l){f=!0;break}f||(f=this.getAttribute(c,l),d.push({type:b.vdom.operation.SET_ATTRIBUTE,target:a,
name:l,value:f}))}}c.nodeType===b.vdom.node.TEXT&&c.textContent!=a.textContent&&d.push({type:b.vdom.operation.SET_TEXT_CONTENT,target:a,value:c.textContent});l=c.childNodes?c.childNodes.length:0;g=a.childNodes?a.childNodes.length:0;for(f=0;f<l;f++)e=c.childNodes[f],(h=a.childNodes?a.childNodes[f]:null)?b.isEmpty(e)?d.push({type:b.vdom.operation.REMOVE_CHILD,target:a,child:a.childNodes[f]}):h.nodeType!==e.nodeType||h.tagName!==e.tagName?e.nodeType!==b.vdom.node.COMPONENT&&d.push({type:b.vdom.operation.REPLACE_CHILD,
target:a,child:e,oldChild:h}):d=d.concat(this.diff(h,e)):b.isEmpty(e)||d.push({type:b.vdom.operation.APPEND_CHILD,target:a,child:e});if(l<g)for(c=l;c<g;c++)d.push({type:b.vdom.operation.REMOVE_CHILD,target:a,child:a.childNodes[c]});return d},createRealNode:function(a,c){var e;if(a.nodeType===b.vdom.node.TEXT)e=document.createTextNode(a.textContent);else if(a.nodeType===b.vdom.node.ELEMENT){e=document.createElement(a.tagName);if(a.attributes)for(var d in a.attributes){var g=a.attributes[d];"function"===
typeof g&&(g=g.bind(c));this.setAttribute(e,d,g)}if(a.childNodes){d=document.createDocumentFragment();for(g=0;g<a.childNodes.length;g++){var f=a.childNodes[g];f&&d.appendChild(this.createRealNode(f,c))}e.appendChild&&e.appendChild(d)}}else a.nodeType===b.vdom.node.COMPONENT&&(e=document.createElement("DIV"),b.mount(e,a.tagName,a.attributes));return e},createVirtualNode:function(a,c,e){b.isDefined(e)||b.isObject(c)||(e=c,c=null);b.isObject(a)?a={nodeType:b.vdom.node.COMPONENT,tagName:a,attributes:c}:
(a={tagName:a.toString().toUpperCase(),nodeType:b.vdom.node.ELEMENT,attributes:c},b.isArray(e)?a.childNodes=e:b.isObject(e)?a.childNodes=[e]:b.isEmpty(e)||(a.childNodes=[{nodeType:b.vdom.node.TEXT,textContent:e}]));a.$virtual=!0;return a}}})(sn||(sn={}));var el=sn.vdom.createVirtualNode;
(function(b){b.router={routes:{},params:[],named_params:{},enabled:!1,getPath:function(){var a=window.location.href.match(/#(.*)$/);return"/"+this.clearSlashes(a?a[1]:"")},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},param:function(a,c){return b.isInteger(a)?this.params[a]||c:this.named_params[a]||c},update:function(){var a=this,c=this.getPath(),e=[],d={},c=c.replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(c,a,b){d[a]=decodeURIComponent(b);return""}),g={},f;for(f in this.routes){g.rule=
f;var h="^"+g.rule.replace(/:[^/]+/g,"([^/]+)")+"$";if(h=c.match(h)){h.shift();var c=g.rule.match(/:([^/:]+)/g),k;for(k in c)f=decodeURIComponent(h[k]),e.push(f),d[c[k].replace(":","")]=f;this.params=e;this.named_params=d;setTimeout(function(c){return function(){b.log("Taking route "+c.rule);a.routes[c.rule]()}}(g),0);break}g={rule:g.rule}}},setEnabled:function(a){!0!==a||this.enabled?a||(window.removeEventListener("hashchange",this.update.bind(this)),this.enabled=!1):(window.addEventListener("hashchange",
this.update.bind(this)),this.enabled=!0,this.update())},setRoutes:function(a){this.routes=a;this.setEnabled(!0)},route:function(a,c){if(c)for(var b in c)a=a.replace(":"+b,encodeURIComponent(c[b]));window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a}}})(sn||(sn={}));
(function(b){b.component={lifeCycle:["init","update","render","dispose"],abortComponentRendering:function(c){c.$pendingRendering&&(b.log("Ignoring rendering request of component <"+c.definition.name+">"),clearTimeout(c.$pendingRendering))},requestComponentRendering:function(c){this.abortComponentRendering(c);c.$pendingRendering=setTimeout(function(){c.render();c.$pendingRendering=null},0)},observablePropertyChanged:function(c,a,d,g,f,h){b.log("Rendering component <"+c.definition.name+"> triggered by <"+
g.toString()+"> of scope <!"+a+">");this.requestComponentRendering(c);if(c=d.$observers?d.$observers[g]:null)for(var k in c)c[k](f,h)},observe:function(c,a,b){a.$observers||(a.$observers={});a.$observers[c]||(a.$observers[c]=[]);a.$observers[c].push(b)}};var a=function(c){this.definition=c;this.observables=[];this.scope=this.createScope()};a.prototype.createScope=function(c){var a=this,d=b.guid();return new Proxy(c||{},{get:function(c,f){var h=d+f.toString();!b.isDefined(c[f])||b.isFunction(c[f])||
"__proto__"===f||f.toString().startsWith("$")||b.inArray(a.observables,h)||(b.log("Observing property <"+f.toString()+"> of scope <"+d+">"),a.observables.push(h));return c[f]},set:function(c,f,h){var k=d+f.toString(),m=c[f];"object"===typeof h&&(h=a.createScope(h));c[f]=h;h!==m&&!b.isFunction(h)&&b.inArray(a.observables,k)&&b.component.observablePropertyChanged(a,d,c,f,h,m);return!0}})};a.prototype.mount=function(c,a){b.log("Mounting component <"+this.definition.name+">");var d=b.vdom.getAttribute(c,
"data-sn-component");b.isDefined(d)&&d.dispose();b.vdom.setAttribute(c,"data-sn-component",this);this.container=c;for(var g in this.definition)"function"==typeof this.definition[g]&&0>b.component.lifeCycle.indexOf(g)&&(this.scope[g]=this.definition[g]);this.init(a);this.update(a);b.log("Component <"+this.definition.name+"> mounted")};a.prototype.controller=function(c,a){if(this.definition[c])if(arguments){var b=[],g;for(g in a)b.push(a[g]);this.definition[c].apply(this.scope,b)}else this.definition[c].call(this.scope)};
a.prototype.init=function(a){this.controller("init",a);b.log("Component <"+this.definition.name+"> initialized")};a.prototype.update=function(a){this.controller("update",a);b.component.requestComponentRendering(this);b.log("Component <"+this.definition.name+"> updated")};a.prototype.render=function(){if(this.definition.render){var a=this.definition.render.call(this.scope),a=b.vdom.createVirtualNode(this.container.tagName,null,a),a=b.vdom.diff(this.container,a,!0);b.vdom.patch(a,this.scope);b.log("Component <"+
this.definition.name+"> rendered")}};a.prototype.dispose=function(){b.component.abortComponentRendering(this);this.definition.dispose&&this.definition.dispose.call(this.scope);b.log("Component <"+this.definition.name+"> unmounted")};b.Component=a})(sn||(sn={}));
(function(b){var a=function(a,e,d,g){this.url=e;this.method=a;this.data=d;this.options=b.extend({timeout:5E3,async:!0,withCredentials:!1,ct:"application/x-www-form-urlencoded"},g||{});this.init()};a.prototype.abort=function(){this.xhr.abort();this.failCallback&&this.failCallback(this.xhr.status);this.alwaysCallback&&this.alwaysCallback()};a.prototype.init=function(){var a=this;try{this.xhr=new XMLHttpRequest}catch(e){try{this.xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){return b.error("XMLHttpRequest not supported"),
null}}this.xhr.withCredentials&&(this.xhr.withCredentials=this.options.withCredentials);this.xhr.onreadystatechange=function(){4==a.xhr.readyState&&(clearTimeout(a.requestTimeout),200!=a.xhr.status?a.failCallback&&a.failCallback(a.xhr.responseText,a.xhr):a.successCallback&&a.successCallback(a.xhr.responseText,a.xhr),a.alwaysCallback&&a.alwaysCallback(a.xhr.responseText,a.xhr))};this.requestTimeout=setTimeout(function(){a.abort()},this.options.timeout);this.xhr.open(this.method.toUpperCase(),this.url,
this.options.async);this.data?(this.xhr.setRequestHeader("Content-type",this.options.ct),this.xhr.send(this.data)):this.xhr.send(null)};a.prototype.success=function(a){this.successCallback=a;return this};a.prototype.fail=function(a){this.failCallback=a;return this};a.prototype.always=function(a){this.alwaysCallback=a;return this};b.RequestObject=a;b.request={get:function(a,e,d){return new b.RequestObject("GET",a,e,d)},post:function(a,e,d){return new b.RequestObject("POST",a,e,d)}}})(sn||(sn={}));
(function(b){b.validation={required:function(a){return!b.isEmpty(a)}}})(sn||(sn={}));
(function(b){b.FormField={name:"FormField",init:function(a,e,d,g){var f=this;this.value=a[e]||"";b.component.observe(e,a,function(a,c){f.value=a})},update:function(a,e,d,g){var f=this;this.form=a;this.attributes=b.extend({name:e,onchange:function(a){a=a.target.value;f.form.$errors[e]=f.form.validateField(e,a);f.value=a;f.form.setFieldValue(e,a);f.form.$pristine=!1}},d||{})},render:function(){var a=b.extend({},this.attributes),e=b.isEmpty(a["class"]||"")?"":" ";b.isEmpty(this.form.$errors[a.name])?
e+="sn-valid":(e+="sn-invalid",this.form.$errors[a.name].map(function(a){e+=" sn-invalid-"+a.replace("_","-")}));a["class"]=e;var d=this.options?"select":!0===a.multiline?"textarea":"input";switch(d){case "input":a.type||(a.type="text");break;case "textarea":delete a.multiline}a.value=this.value;return el(d,a)}};var a=function(a){this.$rules=a||{};this.$errors={};this.$pristine=!0};a.prototype.isValid=function(){for(var a in this.$errors)if(!b.isEmpty(this.$errors[a]))return!1;return!0};a.prototype.isPristine=
function(){return this.$pristine};a.prototype.setFieldValue=function(a,b){this[a]=b};a.prototype.validateField=function(a,e){var d=[],g=this.$rules[a];if(!b.isEmpty(g)){b.isArray(g)||(g=[g]);for(var f in g){var h=g[f];!0!==b.validation[h](e)&&d.push(h)}}return d};a.prototype.field=function(a,e,d){return el(b.FormField,{form:this,name:a,attributes:e,options:d})};b.Form=a})(sn||(sn={}));
(function(b){b.config={logPrefix:"sn: ",debug:!0};b.error=function(a){if(!0===b.config.debug)throw Error(b.config.logPrefix+a);};b.log=function(a){!0===b.config.debug&&console.log(b.config.logPrefix+a)};b.extend=function(a,b){return Object.assign?Object.assign(a,b):a};b.isObject=function(a){return"object"===typeof a};b.isArray=function(a){return Array.isArray(a)};b.isDefined=function(a){return void 0!==a&&null!==a};b.isFunction=function(a){return"function"===typeof a};b.inArray=function(a,b){return 0<=
a.indexOf(b)};b.isInteger=function(a){var b;return isNaN(a)?!1:(b=parseFloat(a),(0|b)===b)};b.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};b.isEmpty=function(a){return!b.isDefined(a)||""===a||b.isArray(a)&&1>a.length||b.isObject(a)&&1>Object.keys(a).length};b.mount=function(a,c,e){var d=b.vdom.getAttribute(a,"data-sn-component");d&&d.definition===c?d.update(e):(new b.Component(c)).mount(a,
e)}})(sn||(sn={}));
